<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <link rel="stylesheet" href="stylesheet.css">
  </head>
  <body>
    <script>
      $(document).ready(function(){
      var $body = $('body');
      $body.html('');
      var $header = $('<h1>Twittler</h1></br><h3>A platform for</h3>');
      $body.append($header);
      $header.click( function () {
        goBackHome()
      });
      var $sa = $(
        '<div id="tweetSpace" style="overflow-y:scroll;overflow-x:hidden; width: 700px ;height:500px;background-color:none; float: right">'+
        '<p id="sa"></p>'
        + '</div>'
      );

      $sa.appendTo($body);

      // var $header = $("<h1>Twittler</h1>");
      // $header.css({color: "blue" });
      // $header.appendTo($body);


      var index;

      var latestIndex = 0;

      var newTweetsInterval;

      var allUsers = ['shawndrost', 'sharksforcheap', 'mracus', 'douglascalhoun'];
      var displayOnlyUser = allUsers;

      var printNewTweets = function () {
        var i = streams.home.length - 1;
        var leftOffAt = latestIndex;
        while(i >= leftOffAt){
          var tweet = streams.home[i];
          var $tweet = $("<div class= \"tweet " + tweet.user + "\"></div>");
          $tweet.click( function () {
            goToProfile(tweet.user)
          });

          if(displayOnlyUser.includes(tweet.user)) {
            $tweet.html("<strong class=\"username " + tweet.user + "\">@" + tweet.user + "</strong>" +
            '<em class=\"message\">'+ tweet.message + '</em><br />' +
            "<span class=timestamp>"+ tweet.created_at + "</span><br />"
            );
            $tweet.prependTo($sa);
          } else {
            return;
          }
          i -= 1;
        }
      }


    newTweetsInterval = function (){

      setInterval( function() {
          var copy = streams.home.slice();
          var latestTweetsOnly = copy.slice(latestIndex);
          latestIndex = copy.length - 1;
          printNewTweets();

        }, 2000);

    };





     // var goBack = function () {
     //   window.history.back();
     // }

     var goBackHome = function () {
       goToProfile(allUsers);
     }

     // var clickerFunc = function () {
     //   var el = document.getElementsByClassName('mracus');
     //   for (var i=0; i < el.length; i++) {
     //     console.log(el);
     //     el.item[i].onclick = goToProfile('mracus');
     //   }
     // }();


     var goToProfile = function (user) {
       clearInterval(newTweetsInterval);
       if(user === allUsers) {
         displayOnlyUser = allUsers;
         $(".username").display;
       } else {
         displayOnlyUser = [user];
         leftOffAt = streams.home.length - 1;

         var everyoneElse = allUsers.filter( function(name) {
           return name !== user;
         })


         everyoneElse.forEach( function(user){
           console.log("I should hide ." + user);
           $("." + user).hide();

         })
       }

     };

     newTweetsInterval();

   });


    </script>
  </body>
</html>
